{% extends 'base.html.twig' %}

{% block title %}Accueil - {{ parent() }}{% endblock %}

{% block body %}
    <!-- Hero Section -->
    <section class="box hero is-medium has-background-light ">
        <div class="hero-body">
            <div class="container">
                <div class="columns is-vcentered">
                    <div class="column is-6">
                        <h1 class="title is-1 mb-4">
                            Bienvenue sur Sortir.com
                        </h1>
                        <h2 class="subtitle is-4 mb-5">
                            La plateforme des stagiaires ENI pour organiser vos sorties extra-scolaires
                        </h2>
                        <p class="subtitle is-6 mb-5">
                            Conçue par les étudiants POUR les étudiants !
                        </p>
                        {% if not app.user %}
                            <div class="buttons">
                                <a href="{{ path('app_login') }}" class="button is-primary is-medium">
                                    <span class="icon"><i class="fas fa-sign-in-alt"></i></span>
                                    <span>Se connecter</span>
                                </a>
                            </div>
                        {% else %}
                            <div class="buttons">
                                <a href="{{ path('sortie_index') }}" class="button is-primary is-medium">
                                    <span class="icon"><i class="fas fa-calendar-alt"></i></span>
                                    <span>Voir les sorties</span>
                                </a>
                                <a href="{{ path('sortie_create') }}" class="button is-success is-medium">
                                    <span class="icon"><i class="fas fa-plus"></i></span>
                                    <span>Créer une sortie</span>
                                </a>
                            </div>
                        {% endif %}
                    </div>
                    <div class="column is-6">
                        <figure class="image box">
                            <img src="{{ asset('images/groupe2.png') }}" alt="Groupe de personnes lors d'une sortie" onerror="this.src='/api/placeholder/600/400';this.onerror='';">
                        </figure>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="section">
        <div class="container">
            <h2 class="title is-2 has-text-centered mb-6">Pourquoi utiliser Sortir.com ?</h2>

            <div class="columns is-multiline">
                <div class="column is-4">
                    <div class="box has-text-centered has-background-white-ter h-100">
                        <span class="icon is-large mb-4" style="color: var(--bulma-primary);">
                            <i class="fas fa-calendar-check fa-3x"></i>
                        </span>
                        <h3 class="title is-4">Organisez facilement</h3>
                        <p>Créez des sorties en quelques clics et gérez automatiquement les inscriptions.</p>
                    </div>
                </div>

                <div class="column is-4">
                    <div class="box has-text-centered has-background-white-ter h-100">
                        <span class="icon is-large mb-4" style="color: var(--bulma-primary);">
                            <i class="fas fa-users fa-3x"></i>
                        </span>
                        <h3 class="title is-4">Créez du lien</h3>
                        <p>Rencontrez d'autres stagiaires et développez votre réseau professionnel.</p>
                    </div>
                </div>

                <div class="column is-4">
                    <div class="box has-text-centered has-background-white-ter h-100">
                        <span class="icon is-large mb-4" style="color: var(--bulma-primary);">
                            <i class="fas fa-map-marker-alt fa-3x"></i>
                        </span>
                        <h3 class="title is-4">Par campus</h3>
                        <p>Trouvez des sorties près de votre campus ou participez à des événements inter-campus.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Events à venir -->
    {% if sorties is defined and sorties|length > 0 %}
        <section class="box hero is-medium has-background-light">
            <div class="container">
                <h2 class="title is-2 has-text-centered mb-6">Sorties à venir</h2>

                <div class="columns is-multiline">
                    {% for sortie in sorties %}
                        <div class="column is-4">
                            <div class="card event-card h-100">
                                <div class="card-image">
                                    <figure class="image ">
                                        <img src="{{ asset('uploads/activites/afterwork' ~ random(1, 5) ~ '.webp') }}" alt="{{ sortie.nom }}" onerror="this.src='/api/placeholder/400/300';this.onerror='';">
                                    </figure>
                                    <div class="tag is-primary is-medium" style="position: absolute; top: 10px; right: 10px;">
                                        {{ sortie.campus.nom }}
                                    </div>
                                </div>
                                <div class="card-content">
                                    <p class="title is-5 ">
                                        {% if app.user %}
                                            <a href="{{ path('sortie_detail', {'id': sortie.id}) }}">{{ sortie.nom }}</a>
                                        {% else %}
                                            {{ sortie.nom }}
                                        {% endif %}
                                    </p>

                                    <div class="content">

                                        <div class="tags">
                                             <span class="tag" style="background-color:
                                                 {% if sortie.inscriptions|length is same as sortie.nbInscriptionsMax %}
                                                     lightcoral;
                                                 {% elseif sortie.nbInscriptionsMax - sortie.inscriptions|length < sortie.nbInscriptionsMax/10 %}
                                                     orange;
                                                 {% else %}
                                                     #fff3cd;
                                                 {% endif %}
                                                     color: #856404;">
                                                <span class="icon"><i class="fas fa-users"></i></span>
                                                {{ sortie.inscriptions|length }}/{{ sortie.nbInscriptionsMax }}
                                            </span>
                                            {% if is_granted('IS_AUTHENTICATED') %}
                                                <span class="tag" style="background-color: #f5f5f5;">
                                                    <span class="icon"><i class="fas fa-map-marker-alt"></i></span>
                                                    {{ sortie.lieu.ville }}
                                                </span>
                                            {% endif %}
                                            <span class="tag" style="background-color: #f5f5f5;">
                                                <span class="icon"><i class="fas fa-clock"></i></span>
                                                {{ sortie.dateHeureDebut|date('d/m/Y à H:i') }}
                                            </span>
                                        </div>
                                        <p>{{ sortie.infosSortie|slice(0, 100) }}
                                            {% if sortie.infosSortie|length > 100 %}
                                                ...
                                            {% endif %}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div class="has-text-centered mt-6">
                    <a href="{{ path('sortie_index') }}" class="button is-primary is-medium">
                        <span>Voir toutes les sorties</span>
                        <span class="icon"><i class="fas fa-arrow-right"></i></span>
                    </a>
                </div>
            </div>
        </section>
    {% endif %}




    <!-- Call to Action -->
    <section class="box section has-background-primary">
        <div class="container">
            <div class="has-text-centered has-text-white">
                <h2 class="title is-2 has-text-white mb-4">Prêt à rejoindre la communauté ?</h2>
                <p class="subtitle is-5 has-text-white mb-5">
                    Organisez des sorties, rencontrez d'autres stagiaires et créez des liens durables.
                </p>
                {% if is_granted('ROLE_ADMIN') %}
                    <a href="{{ path('admin_user_add') }}" class="button is-light is-medium">
                        <span class="icon"><i class="fas fa-user-plus"></i></span>
                        <span>Créer un compte</span>
                    </a>
                {% endif %}
                {% if not app.user %}
                    <div class="buttons is-centered">
                        <a href="{{ path('app_login') }}" class="button is-white is-medium">
                            <span class="icon"><i class="fas fa-sign-in-alt"></i></span>
                            <span>Se connecter</span>
                        </a>

                    </div>
                {% else %}
                    <a href="{{ path('sortie_create') }}" class="button is-white is-medium">
                        <span class="icon"><i class="fas fa-plus"></i></span>
                        <span>Organiser une sortie</span>
                    </a>
                {% endif %}
            </div>
        </div>
    </section>
{% endblock %}


{% block stylesheets %}
    {{ parent() }}
    <style>
        .event-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .h-100
        {
            height: 100%;
        }

        .card-footer-item:hover {
            background-color: #f5f5f5;
        }
        .card-footer-item[style*="background-color: var(--bulma-primary)"]:hover {
            background-color: #a50d29 !important; /* Version légèrement plus foncée du rouge principal */
        }

    @media (prefers-color-scheme: dark) {
        /* Modifier spécifiquement les fonds clairs */
        .has-background-light {
            background-color: #252525 !important; /* Fond sombre au lieu de clair */
            color: #f5f5f5 !important; /* Texte clair sur fond sombre */
        }

        /* S'assurer que les titres et sous-titres restent visibles */
        .has-background-light .title,
        .has-background-light .subtitle {
            color: #f5f5f5 !important;
        }

        /* Ajuster également les éléments avec fond blanc */
        .has-background-white-ter {
            background-color: #1e1e1e !important;
            color: #f5f5f5 !important;
        }

        /* Assurer la visibilité du texte dans les boîtes */
        .box {
            background-color: #1e1e1e;
            color: #f5f5f5;
        }
    }




    </style>
{% endblock %}